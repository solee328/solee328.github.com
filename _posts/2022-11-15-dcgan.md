---
layout: post
title: DCGAN
subtitle : Unsupervised Representation Learning With Deep Convolutional Generative Adversarial Networks
# subtitle:
categories: gan
tags: [dcgan, gan, 생성 모델, 논문 구현]
# sidebar: []
use_math: true
---

## 0. 소개
드디어 CNN 계열의 생성 모델로 들어왔습니다! convolution과 transposed convolution을 사용한 것이 특징인 <a href="https://arxiv.org/abs/1511.06434v2" target="_blank">DCGAN</a>을 소개합니다.

classification과 같은 지도학습 task에서 좋은 성능을 보이던 CNN을 비지도 학습 분야인 이미지 생성 task로 가져와 사용한 것이 특징으로 모델의 기능을 증명하기 위한 다양한 실험을 진행했습니다.<br>
Discriminator의 경우 feature extractor로 사용되어 얼마만큼의 성능을 내는지에 대한 실험, Generator의 경우 데이터 셋을 기억하지 않고 생성함에 대한 증명, latent space의 변화 과정, 산술 연산 과정의 실험을 진행하여 생성된 이미지의 시각적인 부분에 대한 증명이 아닌 수치적인 증명까지 자세하게 나와있어 실험에 대한 진심을 느낄 수 있었던 논문입니다.<br>

저는 <a href="https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html" target="_blank">CelebA</a> 데이터셋을 사용해 얼굴 생성에 대한 DCGAN을 구현을 해 관련 실험 부분은 코드와 함께 논문을 설명해드리고 그 외 데이터셋과 실험은 논문 내용을 요약해 설명해드리겠습니다.

## 1.  데이터 셋

### 1.1. 논문 데이터셋
논문에서는 총 3가지의 데이터 셋을 사용했습니다. <a href="https://www.yf.io/p/lsun" target="_blank">LSUN</a>, Face, <a href="https://image-net.org/download.php" target="_blank">ImageNet-1k</a>입니다.

<a href="https://www.yf.io/p/lsun" target="_blank">LSUN</a>은 침실 데이터 셋을 이용했으며 생성 모델이 이미지를 기억해 생성하는 memorization 가능성을 줄이기 위해 이미지 중복 제거 프로세스를 진행했습니다. 이미지를 32x32로 downsampling한 후 3072-128-3072 Denoising AutoEncoder(DAE)와 ReLU activation을 사용했다고 합니다.

---
그림
---

위의 그림과 같은 방식을 사용했다 이해했습니다.
32x32 이미지를 입력으로 넣어 128의 latent vector를 DAE를 이용해 추출한 후 이 벡터를 ReLU를 통해 이진화함으로써 32 bit의 이진화된 코드를 가지게 됩니다.
32 bit의 이진화된 코드는 해시 값이 됩니다. 해시 충돌이 일어난 이미지는 중복 이미지로 처리되게 됩니다. 이 이미지들을 육안으로 검사했을 때 false positive 확률이 1/100 미만이였을 정도로 높은 정밀도를 보여주었다고 하며 거의 275,000개의 이미지를 삭제했으며 높은 recall을 보여주었다고 합니다.

중복 이미지를 삭제하는 방법으로 이미지를 latent vector로 만들어 해시로 사용한다는 부분이 신선했던 부분입니다. 기존 LSUN 침실 데이터 셋의 크기가 3,033,042개로 약 300만개 정도인데 275,000개의 이미지를 삭제한 것은 삭제한 양이 결코 작지 않음에도 해싱 방법으로 효율적으로 처리했다는 것이 대단하다 느껴졌습니다.

Face 데이터의 경우 웹 이미지 쿼리를 통해 현대 사람 얼굴을 포함한 이미지를 추출해 10,000명의 사람들의 300만개의 이미지를 얻었다고 합니다. OpenCV를 이용해 이미지에서 얼굴을 검출해 높은 해상도를 유지한 350,000개의 얼굴이 있는 이미지를 얻었으며 추가적인 augmentation은 적용하지 않은 채 사용했다 합니다.

Imagenet-1k는 32x32의 center-crop한 이미지를 사용했으며 마찬가지로 augmentation은 적용하지 않았다 합니다.

### 1.2. 구현 데이터셋
LSUN의 데이터는 용량이 커서 그런지 다운 중 서버 응답이 끊기는 경우가 계속 발생해 다운에 실패했습니다...(._.  )
대신 Face 데이터를 사용하기로 했는데 웹 쿼리를 사용할 필요 없이 간단하게 사용할 수 있는 CelebA를 사용했습니다ㅎ



## 2. 모델

### 2.1 fractionally strided Convolution


### 2.2. Generator


### 2.3. Discriminator



## 3. 생성 결과


### 3.1. 필터 시각화


### 3.2. 보간 방법


## 4. 논문의 추가 실험

### 4.1. feature extract

### 4.2. (논문)이미지 산술 연산

### 4.3. (논문)객체 삭제
